---
title: "Rapport CYS"
output:
  pdf_document:
    toc: yes
  html_document:
    number_sections: yes
    toc: yes
    toc_float: yes
date: "`r format(Sys.time(), '%d %B, %Y')`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,echo=F}
library(ggplot2)
library(gridExtra)
library(ggfortify)
library(ellipse)
library(leaps)
library(MASS)
library(corrplot)
```

# Etude des données W1_version1

## Les données
```{r}
CYS = read.csv("W1_version1.csv")
head(CYS)
str(CYS)
summary(CYS)
```

```{r}
#  Stat. descriptives à completer
boxplot(CYS$snapshot.1,CYS$snapshot.2,names=c("Snapshot1","Snapshot2"), ylab="Résultat",
        main="Résultats au Snapshot1 et au Snapshot2")
```

Au regard de boxplot, on constate que le Snapshot2 prend souvent les valeurs plus grandes que le Snapshot1 d'où la progresson obtenue en résultat.

```{r}
#  Stat. descriptives à completer
boxplot(CYS$snapshot.2~CYS$CYS.S3,names=c("Non utilisé","Utilisé"), 
        ylab="Résultat Snapshot2 en S3", 
        main=" Résultat Snapshot2 en S3 selon l'utilisation de CYS en S3")
```

```{r}
#  Stat. descriptives à completer
dif_snap=CYS$snapshot.2-CYS$snapshot.1
ratio_snap=CYS$snapshot.2/CYS$snapshot.1
boxplot(dif_snap~CYS$CYS.S3, ylab="Différence de résultat entre Snapshot1 et  
        Snapshot2 en S3", 
        main=" Différence de résultat entre Snapshot1 et  
        Snapshot2 en S3 selon l'utilisation de CYS en S3")
boxplot(ratio_snap~CYS$CYS.S3, ylab="Ratio de résultat entre Snapshot1 et  Snapshot2 
        en S3", 
        main=" Ratio de résultat entre Snapshot1 et  Snapshot2 
        en S3 selon l'utilisation de CYS en S3")
```

```{r}
#  Stat. descriptives à completer
boxplot(dif_snap~CYS$CMI, ylab="Différence de résultat entre Snapshot1 et  Snapshot2 en S3", 
        main=" Différence de résultat entre Snapshot1 et  Snapshot2 en S3 selon CMI en S3")
```
```{r}
#  Stat. descriptives à completer
boxplot(ratio_snap~CYS$CMI, ylab="Ratio de résultat entre Snapshot1 et  Snapshot2 en S3",
        main=" Ratio de résultat entre Snapshot1 et  Snapshot2 en S3 selon CMI en S3")
```
## Test d'un modèle ANOVA de 3 facteurs(CYS S3, CMI, TP S3)


```{r}
# A completer
mod1=lm(dif_snap~(CYS$CYS.S3+CYS$TP.S3+ CYS$CMI)^2,data=CYS)
summary(mod1)
```

```{r}
# A completer - fonction lm
step.backward = step(mod1)
```
Selon le test d'AIC, on trouve le meilleur modèle modAIC1: 

$$ dif\_ snap \sim CYS\$CYS.S3 + CYS\$TP.S3 + CYS\$CMI + CYS\$CYS.S3:CYS\$CMI $$
```{r}
# A completer
modAIC1=lm(dif_snap ~ CYS$CYS.S3 + CYS$TP.S3 + CYS$CMI + CYS$CYS.S3:CYS$CMI,data=CYS)
summary(modAIC1)
anova(modAIC1,mod1)
```
La p_valeur de Test Fisher est 0,2854 supérieure que 0,05 donc on accepte le modèle modAIC1.

```{r}
step.backward = step(mod1,direction="backward",k=log(nrow(CYS)))
```
Selon le test d'BIC, on trouve le meilleur modèle: 

$dif\_snap \sim CYS\$CYS.S3 + CYS\$CMI + CYS\$CYS.S3:CYS\$CMI$

```{r}
# A completer
modBIC1=lm(dif_snap ~ CYS$CYS.S3 + CYS$CMI + CYS$CYS.S3:CYS$CMI,data=CYS)
anova(modBIC1,mod1)
```
La p_valeur de Test Fisher est 0,105 supérieure que 0,05 donc on accepte le modèle modBIC1.
```{r}
# A completer
anova(modBIC1,modAIC1)
```
La p_valeur de Test Fisher est 0,105 supérieure que 0,05 donc on accepte le modèle modBIC1.


```{r}
# A completer
mod2=lm(ratio_snap~(CYS$CYS.S3+CYS$TP.S3+ CYS$CMI)^2,data=CYS)
summary(mod1)
```


```{r}
step.backward = step(mod2,direction="backward",k=log(nrow(CYS)))
```
Selon le test d'BIC, on trouve le meilleur modèle modBIC2: 

$ratio\_snap \sim CYS\$CMI$

De même façon, on trouve le meilleur modèle pour modéliser le ratio_snap:



```{r}
# A completer
modBIC2=lm(ratio_snap ~ CYS$CMI,data=CYS)
anova(modBIC2,mod2)
```
La p_valeur de Test Fisher est 0,31 supérieure que 0,05 donc on accepte le modèle modBIC1.

Conclusion: Grâce au test ANOVA on trouve que:

- Si on considère la différence entre les deux snapshots on obtient le modèle


$dif\_snap \sim CYS\$CYS.S3 + CYS\$CMI + CYS\$CYS.S3:CYS\$CMI$


Cela montre l'impact de CMI et CYS S3 sur l'évolution de résultat.

- SI on considère la ratio entre les deux snapshots on obtient le modèle 


$ratio\_snap \sim CYS\$CMI$


Cela montre l'impact de CMI S3 sur l'évolution de résultat.

Dans ces deux cas on ne trouve pas l'effet de la variable TP S3.












